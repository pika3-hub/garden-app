# 家庭菜園管理アプリ

家庭菜園での作物栽培を管理するWebアプリケーション。

## 機能

- **作物管理**: トマト、なすなどの作物情報を登録・管理（CRUD完備）
- **場所管理**: 畑、プランターなどの栽培場所を管理（CRUD完備）
- **作物紐付け**: どの場所でどの作物を育てているかを記録
- **見取り図エディタ**: キャンバス上で畑のレイアウトを視覚的に描画・管理
  - 図形描画（矩形、円、線）
  - テキスト追加
  - 作物アイコンのドラッグ&ドロップ配置
  - Undo/Redo機能
  - グリッド表示とスナップ機能
  - ズーム機能
  - マルチセレクション
  - キーボードショートカット対応
  - 自動保存
- **管理日記**: 栽培日記の記録・管理
  - 日付、天気、タイトル、本文の記録
  - 作物・場所との関連付け
  - キーワード・日付範囲での検索機能
  - ダッシュボードに最新の日記を表示
- **画像添付機能**: 作物・場所・日記に画像を添付
  - 対応形式: PNG, JPG, JPEG, GIF, WebP
  - 最大16MBまでのファイルをアップロード可能
  - 一覧画面でサムネイル表示、詳細画面で大きく表示
  - 画像の差し替え・削除が可能
- **栽培中の作物一覧**: 現在栽培中のすべての作物を一覧表示
  - 作物名、品種、場所、植え付け日を表示
  - ダッシュボードからワンクリックでアクセス
- **収穫記録機能**: 収穫イベントの詳細な記録・管理
  - 同一作物を複数回収穫記録可能
  - 収穫日、収穫量、単位（kg、個、枚など自由入力）を記録
  - 植え付け日からの日数を自動計算・表示
  - 収穫時のメモ・写真を添付可能
  - 場所詳細ページに収穫履歴を表示
  - 収穫記録一覧での検索・フィルター機能
  - 日記との関連付けが可能
- **カレンダービュー**: 月別カレンダーで栽培活動を一覧表示
  - 作物・場所の登録日、日記、植え付け、収穫、タスクをアイコンで表示
  - 各アイコンをクリックで詳細ページへ遷移
  - 月の前後移動、キーボードショートカット対応
  - 日付を背景に大きく表示し、アイコンを見やすく配置
- **タスク管理機能**: 栽培作業のタスクを管理
  - タスクの登録・編集・削除・検索
  - ステータス管理（未着手/進行中/完了）
  - 期限日の設定とカレンダー連携
  - 作物・場所・栽培記録との関連付け
  - ダッシュボードに未完了タスクを表示

## 技術スタック

### バックエンド
- Python 3.12
- Flask 3.1
- SQLite
- uv (パッケージ管理)

### フロントエンド
- Bootstrap 5
- Fabric.js (キャンバス描画)

## セットアップ

### 1. 依存関係のインストール

```bash
uv sync
```

### 2. データベース初期化

```bash
uv run python -c "from app import create_app; from app.database import init_db; app = create_app(); init_db(app)"
```

### 3. 開発サーバー起動

```bash
uv run python run.py
```

ブラウザで http://localhost:5000 にアクセスしてください。

## プロジェクト構造

```
garden-app/
├── app/                     # アプリケーションパッケージ
│   ├── models/             # データモデル
│   │   ├── crop.py        # 作物モデル
│   │   ├── location.py    # 場所モデル
│   │   ├── location_crop.py # 作物紐付けモデル
│   │   ├── diary.py       # 日記モデル
│   │   ├── harvest.py     # 収穫記録モデル
│   │   ├── calendar.py    # カレンダーモデル
│   │   └── task.py        # タスクモデル
│   ├── routes/            # ルーティング
│   │   ├── crop_routes.py
│   │   ├── location_routes.py
│   │   ├── diary_routes.py
│   │   ├── harvest_routes.py
│   │   ├── calendar_routes.py
│   │   └── task_routes.py
│   ├── templates/         # HTMLテンプレート
│   │   ├── crops/        # 作物関連
│   │   ├── locations/    # 場所関連（見取り図含む）
│   │   ├── diary/        # 日記関連
│   │   ├── harvests/     # 収穫記録関連
│   │   ├── calendar/     # カレンダー関連
│   │   ├── tasks/        # タスク関連
│   │   └── base.html     # ベーステンプレート
│   ├── static/           # 静的ファイル
│   │   ├── js/
│   │   │   ├── main.js
│   │   │   └── canvas-editor.js  # キャンバスエディタ
│   │   └── uploads/      # アップロード画像保存先
│   │       ├── crops/    # 作物画像
│   │       ├── locations/ # 場所画像
│   │       ├── diary/    # 日記画像
│   │       └── harvests/ # 収穫記録画像
│   ├── migrations/       # データベースマイグレーション
│   ├── utils/           # ユーティリティ
│   │   └── upload.py    # 画像アップロードヘルパー
│   ├── schema.sql       # データベーススキーマ
│   ├── database.py      # データベース接続管理
│   └── config.py        # 設定
├── instance/            # インスタンス固有ファイル(DB等)
├── run.py              # アプリケーション起動スクリプト
├── main.py             # アプリケーションエントリポイント
├── test_data.py        # テストデータ投入スクリプト
└── pyproject.toml      # プロジェクト設定
```

## 開発状況

- [x] プロジェクト基盤構築
- [x] データベース設計
- [x] 作物管理機能（CRUD完全実装）
- [x] 場所管理機能（CRUD + 作物紐付け）
- [x] 見取り図キャンバス描画機能（Fabric.js実装）
  - [x] 図形描画（矩形、円、線）
  - [x] テキスト追加
  - [x] 作物アイコン配置
  - [x] Undo/Redo機能
  - [x] グリッド・スナップ機能
  - [x] ズーム機能
  - [x] マルチセレクション
  - [x] キーボードショートカット
  - [x] 自動保存機能
- [x] 管理日記機能（CRUD + 関連付け + 検索）
- [x] ダッシュボード（統計情報 + 最新日記表示）
- [x] データベースマイグレーション機能
- [x] 画像添付機能（作物・場所・日記・収穫記録）
- [x] 栽培中の作物一覧ページ
- [x] 収穫記録機能（CRUD + 日記関連付け + 検索）
- [x] カレンダービュー（月別表示 + アイコン表示 + キーボード操作）
- [x] タスク管理機能（CRUD + ステータス管理 + カレンダー連携）

## 今後の予定
- データエクスポート機能（CSV/PDF）
- ユーザー認証機能
